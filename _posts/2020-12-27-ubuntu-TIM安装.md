---
layout:		post
title:		新版deepin TIM等软件在Ubuntu上的安装办法
date:		2020-12-27
author:		wyj
catalog:	true
tags:
    - linux
---

{:b:.Z .language-bash}

我正在使用的wine TIM版本是非常古老的，古老到腾讯可能不太支持了，不能传图片，不能显示别人分享的网址，（几乎）不能显示图片，也（几乎）不能收文件。所以使用过程中问题很大。然而现在TIM等等的商业软件被从各种仓库中删除了，导致更新一个正常的TIM版本非常困难，折腾了我整整一个晚上。

# 下载方法

我在网上找了半天，发现除了deepin自己的官方商店之外，还是有民间的希望存在的：[星火应用商店](https://www.spark-app.store/)。这个商店是开源的，所以大可不必怀疑安全性。但是我仍然不想安装一个崭新的软件，并且也对它的有效性非常怀疑，就在虚拟机里进行了一次试验。

如果你想要在一个非deepin的Debian系操作系统上安装这个商店，你会需要下载一个deb和一个zip：zip里是依赖包。把zip解压之后，跑一个`sudo apt install ./*.deb`{:b}就可以方便快捷地安装全部依赖包。然后就可以装商店本身了。

安装的过程中，你会需要在软件源里加入一个`.top`网址作为仓库。所以理论上来讲，你完全不需要装这个商店，只需要把这个网址加入`sources.list`就够了，然而我不知道公钥（懒得找了），就算加入了网址，没有公钥的话apt也会拒绝用它来更新。所以我完整地装完了这个商店，也算是支持下国产软件。

然后自然是跑`sudo apt update`{:b}。但是**千万不要手痒！！！！千万不要习惯性地`apt upgrade`{:b}！！！！**这个软件源会把你自己装的electron-ssr和洛雪音乐助手覆盖掉，而且它装的electron-ssr不能正常使用！如果你一不小心upgrade了，就只能手动把那些软件重装一遍了！

安装命令：
```bash
sudo apt install com.qq.tim.spark
```
下载速度很慢，并且由于是国内的网站，挂代理是不能加速的，请耐心等待。装完之后切记一定要把这个`.top`的仓库从源里删掉然后再`apt update`{:b}一遍，否则你这辈子就别想再跑`apt upgrade`{:b}了。

然后我意识到这个商店是真的卵用没有，就把它卸了。

# 调整字体

我是在虚拟机里做的实验，虚拟机里一切正常，装完之后TIM就可以直接用了。然而我在宿主机上遇到了一些问题：UI中的所有简体字全都变成了方块！（很奇怪的是，内容里是正常的）

这是个棘手的问题，我绕了不少弯路，最后是用[这篇文章](https://lossyou.com/post/%E5%BD%BB%E5%BA%95%E8%A7%A3%E5%86%B3wine3.0%E4%B8%AD%E6%96%87%E4%B9%B1%E7%A0%81%E9%97%AE%E9%A2%98)里的办法解决的。或许有人要问了：你不是没有Windows吗，是怎么从Windows下把字体复制过来的呢？这你就不懂了吧，我在之前[装QQ音乐](/2020/03/17/wine%E8%BF%90%E8%A1%8CQQ%E9%9F%B3%E4%B9%90/)的时候还是有Windows的，那时候我就已经把Windows里的字体复制到普通wine里去了，所以我只需要把普通wine下的字体文件拷到deepinwine里去就可以正常运行了。

当然，如果你发现自己压根没有调整字体，显示就直接是正常的了，不要高兴得太早。我的虚拟机里TIM的字体乍一看是正常的，然而点开“群公告”里面就全是方块了。所以建议就算没有发现方块，也要调整字体。

# 效果

UI当然变得非常现代化而美观。字体不再发虚了，图片和网址也能正常显示了，文件也能正常下载了。遗憾的是，仍然不能正常发送图片。由于隐私<del>懒</del>的原因，我无法提供截图。
